# Concurrency Programming
여러 개의 작업이 동시에 실행되도록 프로그램을 개발하는 방법. 동시성을 구현하기 위해서는 스레드를 구현해야 하는데, 직접 스레드를 만들어 수동으로 관리하는 것을 귀찮은 일이다. 그래서 iOS에서는 유저가 직접 스레드를 구현하기보다, 'task를 정의'하면 시스템이 알아서 이를 수행하도록 하는 방식을 채택하고 있다. Cocoa Touch에서는 Operation과 GCD를 제공하고이 두 기술을 활용하면 하드웨어를 최대한 활용해서 빠르고 반응성이 높은 앱을 개발할 수 있다.

## Thread
프로세스 내에서 실제로 작업을 수행하는 주체

앱을 시작하면 새로운 앱 인스턴스(프로세스)가 생성되고 iOS는 실행에 필요한 리소스를 할당한다. 그리고 작업(task)을 시작하는데, 이 때 프로세스 내부에는 이 task를 실행하는 하나 이상의 Thread가 존재한다. 앱에서 여러 개의 작업을 동시에 실행할 수 있는 것은 Thread가 자원을 적절히 분할해서 task를 실행하기 때문이다.

### 최초의 Thread : Main Thread
iOS 앱을 실행하면, Main Thread(UI를 업데이트하고 event를 처리하는)가 자동으로 생성된다. 60fps라면 0.016초 이내에 필요한 코드를 실행하고 리턴해야 한다. 요즘은 iOS 디바이스가 120fps를 지원하는 추세인데, 이 경우는 0.008초 이내에 리턴해야 한다. 디바이스 성능이 뛰어나기 때문에 대부분은 코드는 이 시간내에 실행가능하다. 

### 느린 작업을 위한 Thread : Background Thread
하지만 네트워크 작업이나 파일을 로딩하는 작업은 이것보다 훨씬 느리다. 그래서 Background Thread에서 실행한다. 물론 메인에서 실행한다고 오류가 나는 것은 아니지만 반응성이 심각하게 저하된다. Main Thread는 자동으로 생성되는 반면, Background Thread는 필요할 때마다 직접 추가해야 한다.

### Operation과 GCD
위에서 언급했던 것처럼, iOS 앱을 다룰 때는 Thread를 직접 다루지 않는다. 복잡한 모든 구현은 이미 구현되어 있다. 우리는 Operation과 GCD를 활용해서 '실행할 작업을 구현'하고 '원하는 thread에 추가'하는 방법만 익히면 된다.

Operation은 주로 작업 사이의 의존성을 구현하거나 취소 기능을 구현할 때 사용한다. 나머지는 GCD를 사용한다. GCD(Grand Central Dispatch)는 실행할 작업을 원하는 queue에 추가해두면 멀티코어를 활용해 최대한 빠르게 실행한다. Operation도 내부적으로는 GCD를 활용한다. 

## Queue
Thread에서 실행할 작업을 저장하는 요소

UI 작업은 Main Thread에서 실행되도록 Main Queue에 추가해야 한다. Main Queue도 직접 만들지 않아도 제공해주는 API를 통해 바로 사용 가능하다. 이외에도 일반적인 용도에 적합한 Global Queue도 사용할 수 있고, 필요에 따라 Background Queue를 직접 생성할 수 있다.
